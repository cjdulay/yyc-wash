<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="manifest" href="manifest.json">
  <link rel="icon" type="image/png" href="logo.png">
  <link rel="apple-touch-icon" href="logo.png">
  <title>YYC CAR WASH FORECASTER</title>
  <link rel="stylesheet" href="style.css?v=13">
</head>
<body>

<div id="ios-prompt">
  <p><strong>Install YYC Wash:</strong> Tap the <img src="https://upload.wikimedia.org/wikipedia/commons/d/d3/IOS7_Export_Icon.png" class="ios-icon"> button below and select <strong>"Add to Home Screen"</strong>.</p>
  <button onclick="document.getElementById('ios-prompt').style.display='none'" style="border:none; background:none; color:#007aff; font-weight:bold; float:right;">Close</button>
</div>

<div id="card">
  <div id="final-verdict" class="final-verdict-ribbon">VERDICT: --</div>

  <div class="header">
    <div id="sync-tag" style="font-size: 0.6em; font-weight: 900; color: #94a3b8; text-transform: uppercase; margin-bottom: 5px; letter-spacing: 1px;">
        YYC SENSOR ‚Ä¢ SYNCING...
    </div>
    <div id="status-badge" class="badge">--</div>
    <div id="cur-temp-display" class="cur-temp-sub">--&deg;C Currently</div>
    <div id="judgement-call" class="judgement-call-text">--</div>
    <div id="maintenance-nag" class="maintenance-nag" style="display:none;">‚ö†Ô∏è WASH OVERDUE: 7+ DAYS</div>
  </div>

  <div class="dashboard-grid">
    <div class="tile" onclick="toggleElement('salt-drawer')">
      <span class="stat-label">ROAD CHEMISTRY</span>
      <span id="salt-val" class="stat-val">--</span> <span style="font-size:0.7em; color:#94a3b8;">‚ñº</span>
    </div>
    <div class="tile" onclick="toggleElement('log-drawer')">
      <span class="stat-label">VEHICLE PROFILE</span>
      <span id="last-date" class="stat-val">None</span> <span style="font-size:0.7em; color:#94a3b8;">‚ñº</span>
    </div>
    <div class="tile tile-wide" style="position: relative; overflow: visible;">
      <div onclick="toggleElement('verdict-drawer')" style="width: 100%; height: 100%; display: flex; flex-direction: column; align-items: center; justify-content: center;">
        <span class="stat-label">STRATEGIC OPENING</span>
        <span id="next-val" class="stat-val" style="font-size:0.85em;">--</span> 
        <span style="font-size:0.7em; color:#94a3b8;">‚ñº</span>
      </div>
      <span onclick="event.stopPropagation(); toggleLogicLayers()" style="position: absolute; top: 10px; right: 12px; cursor:pointer; font-size: 0.9em; opacity: 0.6; padding: 4px; z-index: 10;">‚ìò</span>
    </div>
  </div>

  <div id="logic-info" style="display:none; margin: -5px 20px 15px; padding: 18px; font-size: 0.75em; text-align: left; background: #1e293b; border: 1px solid #334155; border-radius: 22px; line-height: 1.6; color: #cbd5e1; box-shadow: inset 0 2px 4px rgba(0,0,0,0.2);">
      <div id="layer-logic">
        <b style="color:var(--gold);">7-DAY STRATEGIC SCAN: METHODOLOGY</b><br>
        <p style="margin-top: 8px; font-size: 0.9em; line-height: 1.4;">
          I analyze 168 hours of future physics to find the <b>Strategic Opening</b>. I don't just look for "no snow"‚ÄîI look for the chemical transition from "tacky" brine to dry dust.
        </p>
        <div style="background: rgba(255,255,255,0.05); padding: 12px; border-radius: 12px; margin: 10px 0; border-left: 3px solid var(--gold);">
            <b style="color:var(--gold); font-size: 0.75em;">HOW I CALCULATE THIS:</b>
            <ul style="padding-left: 18px; margin: 8px 0; font-size: 0.85em; line-height: 1.4;">
                <li><b>The Exclusion Filter:</b> I skip hours warmer than -2¬∞C or colder than -18¬∞C.</li>
                <li><b>Curb-Melt Lag:</b> I factor in 12‚Äì24 hours of "Lag" after snow events.</li>
                <li><b>The Confidence Rank:</b> 20km/h wind is ranked 2x higher to skip the <b>"Tacky" Phase</b>.</li>
            </ul>
        </div>
        <div onclick="switchLayer('layer-physics')" style="margin-top:15px; color:var(--gold); text-align:center; cursor:pointer; font-weight:800; border: 1px solid rgba(255,255,255,0.1); padding: 10px; border-radius: 12px; background: rgba(255,255,255,0.03);">
            üî¨ ENTER THE PHYSICS LAB ‚ñº
        </div>
      </div>

      <div id="layer-physics" style="display:none;">
          <div style="background: rgba(0,0,0,0.2); padding: 15px; border-radius: 18px; margin-bottom: 20px; text-align: center; border: 1px solid rgba(255,255,255,0.05);">
            <div style="font-size: 0.65em; font-weight: 900; color: #94a3b8; text-transform: uppercase; letter-spacing: 1px; margin-bottom: 10px;">Current Corrosion Kinetics</div>
            <div style="position: relative; width: 100%; height: 12px; background: linear-gradient(to right, #10b981 0%, #fbbf24 50%, #f43f5e 100%); border-radius: 6px; margin: 10px 0;">
              <div id="corrosion-needle" style="position: absolute; top: -4px; left: 0%; width: 4px; height: 20px; background: white; border-radius: 2px; box-shadow: 0 0 10px rgba(255,255,255,0.8); transition: left 0.8s cubic-bezier(0.34, 1.56, 0.64, 1);"></div>
            </div>
            <div id="corrosion-desc" style="margin-top: 12px; font-size: 0.85em; font-weight: 700; color: #cbd5e1;">Calculating...</div>
          </div>
          <div onclick="switchLayer('layer-logic')" style="color:#94a3b8; text-align:center; cursor:pointer; font-weight: 700; border-top: 1px solid rgba(255,255,255,0.05); padding-top: 10px;">‚óÄ BACK</div>
      </div>
  </div>

  <div id="salt-drawer" class="drawer">
      <span id="salt-logic-text">--</span><br><br>
      <b>Chassis Health:</b> Liquid brine sticks to brake lines and fuel tank straps. Undercarriage rinses are mandatory.
  </div>

  <div id="log-drawer" class="drawer" style="padding: 20px; color: white;">
    <div style="font-weight:900; border-bottom:1px solid #334155; padding-bottom:8px; margin-bottom:15px; letter-spacing:1px; color:#94a3b8; font-size:0.7em; text-transform:uppercase;">Vehicle Profile</div>
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:12px;">
      <span>Hybrid / EV Owner</span>
      <input type="checkbox" id="ev-toggle" onchange="saveProfile()">
    </div>
    <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:20px;">
      <span>Strict Mode</span>
      <input type="checkbox" id="risk-toggle" onchange="saveProfile()" checked>
    </div>
    <div id="log-list" style="margin-bottom:20px; font-size:0.9em; max-height:200px; overflow-y:auto; color:#cbd5e1;">No entries.</div>
    <button class="btn btn-log" onclick="addNewWash()">+ LOG NEW WASH</button>
  </div>

  <div id="verdict-drawer" class="drawer">
    <b>üìã Opening Analysis:</b><br>
    <span id="verdict-text">--</span><br>
    <span id="solar-verdict-display" style="display:block; margin-top:8px; color:var(--gold); font-weight:800;"></span>
  </div>

  <div class="alerts-area">
    <div id="log-reminder-prompt" class="banner amber" onclick="toggleElement('log-reminder-drawer')">
      <span>üìù</span><div class="b-info"><b>ACTION: LOG A WASH</b></div>
    </div>
    <div id="fluid-alert" class="banner orange" onclick="toggleElement('fluid-drawer')">
      <span>üå´Ô∏è</span><div class="b-info"><b>VISIBILITY: HIGH SALT-FILM</b></div>
    </div>
    <div id="ice-alert" class="banner indigo" onclick="toggleElement('ice-drawer')">
      <span>üßä</span><div class="b-info"><b>SAFETY: BLACK ICE RISK</b></div>
    </div>
    <div id="plugin-alert" class="banner blue" onclick="toggleElement('plugin-drawer')">
      <span>üîå</span><div class="b-info"><b>ENGINE: PLUG-IN REQUIRED</b></div>
    </div>
    <div id="regen-alert" class="banner indigo" onclick="toggleElement('regen-drawer')">
      <span>üîã</span><div class="b-info"><b>DRIVING: REGEN LIMITED</b></div>
    </div>
    <div id="rust-alert" class="banner amber" onclick="toggleElement('rust-drawer')">
      <span>üß™</span><div class="b-info"><b>CHASSIS: PEAK CORROSION</b></div>
    </div>
    <div id="freeze-alert" class="banner blue" onclick="toggleElement('freeze-drawer')">
      <span>‚è±Ô∏è</span><div class="b-info"><b id="freeze-val">-- MIN UNTIL FREEZE</b></div>
    </div>
    <div id="chip-alert" class="banner orange" onclick="toggleElement('chip-drawer')">
      <span>üíé</span><div class="b-info"><b>DAMAGE: HIGH CHIP RISK</b></div>
    </div>
  </div>

  <div id="forecast"></div>

  <div class="fact-box">
    <div style="font-weight:900; color:var(--gold); font-size:0.75em; text-transform:uppercase;">YYC Insider Insight</div>
    <div id="random-fact">--</div>
  </div>

  <div class="footer">YYC CAR WASH FORECASTER</div>
</div>

<script src="app.js?v=13"></script>
</body>
</html>
